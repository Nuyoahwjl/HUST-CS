from math import pi
import matplotlib.pyplot as plt

def plot_metrics(train_loss, train_psnr, val_loss, val_psnr):
    model_name = f"SRCNN_x3"
    plt.figure(figsize=(12, 4))
    # 绘制 Loss 曲线
    plt.subplot(1, 2, 1)
    plt.plot(train_loss, label='Train Loss', color='blue')
    plt.plot(val_loss, label='Validation Loss', color='orange')
    plt.title(f'{model_name}_Loss Curve', fontsize=16)
    plt.xlabel('Epochs', fontsize=12)
    plt.ylabel('Loss', fontsize=12)
    plt.legend()
    plt.grid(True, linestyle='--', linewidth=0.6, alpha=0.7)
    # 绘制 PSNR 曲线
    plt.subplot(1, 2, 2)
    plt.plot(train_psnr, label='Train PSNR', color='green')
    plt.plot(val_psnr, label='Validation PSNR', color='red')
    plt.title(f'{model_name}_PSNR Curve', fontsize=16)
    plt.xlabel('Epochs', fontsize=12)
    plt.ylabel('PSNR (dB)', fontsize=12)
    plt.legend()
    plt.grid(True, linestyle='--', linewidth=0.6, alpha=0.7)
    # 调整布局并保存图片
    plt.tight_layout()
    # plt.savefig('metrics.png')
    # plt.close()
    plt.show()


def plot_radar_chart(metrics, labels, title="Radar Chart"):
    num_vars = len(labels)

    angles = [n / float(num_vars) * 2 * pi for n in range(num_vars)]
    angles += angles[:1]  # Close the circle

    fig, ax = plt.subplots(figsize=(6, 6), subplot_kw=dict(polar=True))

    for metric, label in zip(metrics, labels):
        values = metric + metric[:1]  # Close the circle
        ax.plot(angles, values, linewidth=2, linestyle='solid', label=label)
        ax.fill(angles, values, alpha=0.25)

    ax.set_yticks([])
    ax.set_xticks(angles[:-1])
    ax.set_xticklabels(labels, fontsize=10)

    ax.set_title(title, fontsize=14, pad=20)
    ax.legend(loc='upper right', bbox_to_anchor=(1.3, 1.1), fontsize=10)

    ax.grid(color='gray', linestyle='--', linewidth=0.5, alpha=0.7)
    plt.tight_layout()
    plt.show()

if __name__ == "__main__":
    train_loss = [
        0.2829, 0.2592, 0.2240, 0.1685, 0.1027, 0.0536, 0.0381, 0.0347, 0.0325, 0.0311,
        0.0290, 0.0273, 0.0246, 0.0225, 0.0204, 0.0186, 0.0169, 0.0155, 0.0142, 0.0130,
        0.0123, 0.0112, 0.0106, 0.0102, 0.0099, 0.0093, 0.0088, 0.0085, 0.0082, 0.0078,
        0.0077, 0.0072, 0.0070, 0.0067, 0.0066, 0.0065, 0.0063, 0.0059, 0.0059, 0.0057,
        0.0056, 0.0055, 0.0054, 0.0052, 0.0051, 0.0050, 0.0049, 0.0047, 0.0046, 0.0045,
        0.0045, 0.0044, 0.0042, 0.0041, 0.0040, 0.0039, 0.0037, 0.0037, 0.0038, 0.0036,
        0.0034, 0.0034, 0.0033, 0.0033, 0.0032, 0.0032, 0.0031, 0.0032, 0.0031, 0.0030,
        0.0029, 0.0028, 0.0028, 0.0029, 0.0028, 0.0028, 0.0028, 0.0027, 0.0027, 0.0026,
        0.0026, 0.0026, 0.0026, 0.0025, 0.0025, 0.0025, 0.0025, 0.0025, 0.0024, 0.0024,
        0.0024, 0.0024, 0.0023, 0.0024, 0.0023, 0.0023, 0.0023, 0.0023, 0.0023, 0.0023
    ]

    train_psnr = [
        6.16, 6.58, 7.29, 8.84, 11.98, 17.86, 21.43, 21.21, 21.91, 22.01,
        21.90, 21.98, 22.20, 22.35, 22.45, 22.58, 22.70, 22.85, 23.03, 23.24,
        23.42, 23.87, 24.03, 24.24, 24.28, 24.67, 25.01, 25.27, 25.44, 25.54,
        25.65, 26.02, 26.08, 26.11, 26.18, 26.21, 26.19, 26.34, 26.44, 26.57,
        26.63, 26.75, 26.88, 26.91, 26.96, 27.06, 27.11, 27.21, 27.31, 27.38,
        27.38, 27.46, 27.67, 27.72, 27.83, 28.05, 28.17, 28.31, 28.30, 28.43,
        28.68, 28.69, 28.77, 28.73, 28.87, 28.88, 28.91, 28.92, 28.90, 29.19,
        29.24, 29.29, 29.44, 29.30, 29.40, 29.30, 29.50, 29.49, 29.62, 29.59,
        29.64, 29.61, 29.72, 29.75, 29.80, 29.89, 29.81, 29.87, 29.83, 29.93,
        29.99, 30.02, 30.02, 30.09, 30.08, 30.12, 29.98, 30.10, 30.21, 30.17
    ]

    val_loss = [
        0.2308, 0.2027, 0.1578, 0.0996, 0.0454, 0.0208, 0.0180, 0.0145, 0.0137, 0.0131,
        0.0125, 0.0116, 0.0108, 0.0101, 0.0094, 0.0088, 0.0083, 0.0079, 0.0074, 0.0070,
        0.0066, 0.0063, 0.0059, 0.0057, 0.0055, 0.0052, 0.0050, 0.0048, 0.0046, 0.0044,
        0.0043, 0.0041, 0.0040, 0.0038, 0.0037, 0.0036, 0.0035, 0.0034, 0.0032, 0.0031,
        0.0031, 0.0030, 0.0029, 0.0028, 0.0028, 0.0027, 0.0026, 0.0026, 0.0025, 0.0025,
        0.0024, 0.0024, 0.0023, 0.0023, 0.0022, 0.0022, 0.0021, 0.0021, 0.0020, 0.0020,
        0.0020, 0.0019, 0.0019, 0.0019, 0.0018, 0.0018, 0.0018, 0.0018, 0.0017, 0.0017,
        0.0017, 0.0017, 0.0016, 0.0016, 0.0016, 0.0016, 0.0016, 0.0016, 0.0015, 0.0015,
        0.0015, 0.0015, 0.0015, 0.0015, 0.0015, 0.0014, 0.0014, 0.0014, 0.0014, 0.0014,
        0.0014, 0.0014, 0.0014, 0.0014, 0.0013, 0.0013, 0.0013, 0.0013, 0.0013, 0.0013
    ]

    val_psnr = [
        6.63, 7.22, 8.40, 10.65, 15.15, 22.86, 21.48, 22.68, 23.19, 23.01,
        22.99, 23.16, 23.26, 23.39, 23.45, 23.51, 23.70, 23.81, 24.06, 24.16,
        24.42, 24.62, 24.76, 24.97, 25.15, 25.38, 25.51, 25.69, 25.88, 26.08,
        26.26, 26.40, 26.56, 26.69, 26.83, 26.93, 27.07, 27.12, 27.39, 27.62,
        27.74, 27.82, 27.99, 28.10, 28.23, 28.33, 28.33, 28.46, 28.56, 28.51,
        28.74, 28.80, 28.91, 29.01, 29.08, 29.24, 29.37, 29.46, 29.55, 29.63,
        29.70, 29.77, 29.82, 29.91, 29.98, 30.01, 30.10, 30.17, 30.21, 30.26,
        30.31, 30.37, 30.41, 30.45, 30.50, 30.55, 30.59, 30.63, 30.67, 30.70,
        30.72, 30.77, 30.80, 30.84, 30.86, 30.91, 30.92, 30.97, 30.99, 31.02,
        31.05, 31.08, 31.08, 31.13, 31.17, 31.17, 31.23, 31.24, 31.28, 31.30
    ]

    plot_metrics(train_loss, train_psnr, val_loss, val_psnr)

    metrics = [
        [0.8, 0.6, 0.7, 0.9, 0.85],
        [0.7, 0.8, 0.6, 0.75, 0.8]
    ]
    labels = ["Accuracy", "Precision", "Recall", "F1-Score", "AUC"]
    title = "Model Performance"
    plot_radar_chart(metrics, labels, title)