## 题目1

#### (1)
- **1.**
源ip地址为13-16字节，目的ip地址为17-20字节
***H发送：1、3、4***

- **2.**
    - 编号1：H->S (SYN)
    - 编号2：S->H (SYN, ACK)
    - 编号3：H->S (URG, ACK)
    - 编号4：H->S (ACK, PSH)
    - 编号5：S->H (ACK)
***因此，编号1、2和3完成了TCP连接建立过程***

- **3.**
***编号3、5进行了填充(总长度<46)***

#### (2) 
$0x846b41d6 - 0x846b41c5 = 0x00000011 = 17 bytes$

#### (3)
`TTL`由$0x40$变为$0x31$，说明经过了15个路由器。

---

## 题目2

- **B部门**：192.168.1.0/25
  - 子网掩码：255.255.255.128
  - 可用IP范围：192.168.1.1 ~ 192.168.1.126（126个可用地址）
  - 网络地址：192.168.1.0
  - 广播地址：192.168.1.127

- **A部门**：192.168.1.128/27
  - 子网掩码：255.255.255.224
  - 可用IP范围：192.168.1.129 ~ 192.168.1.158（30个可用地址）
  - 网络地址：192.168.1.128
  - 广播地址：192.168.1.159

- **C部门**：192.168.1.160/27
  - 子网掩码：255.255.255.224
  - 可用IP范围：192.168.1.161 ~ 192.168.1.190（30个可用地址）
  - 网络地址：192.168.1.160
  - 广播地址：192.168.1.191

- **D部门**：192.168.1.192/27
  - 子网掩码：255.255.255.224
  - 可用IP范围：192.168.1.193 ~ 192.168.1.222（30个可用地址）
  - 网络地址：192.168.1.192
  - 广播地址：192.168.1.223

---

## 题目3
根据距离向量算法，更新路由器的路由表需要以下步骤：对于每个目的网络，计算通过路由器C的路径距离（即当前路由器到C的距离加上C到目的网络的距离），然后与当前路由表中的距离比较，选择距离更短的路径。如果距离相同，则保持当前下一跳。

假设当前路由器到C的链路代价为1。

计算通过C的路径距离：
- 通过C到N1的距离：由于C未报告N1，距离为无穷大（∞）
- 通过C到N2的距离：1 + 4 = 5
- 通过C到N3的距离：1 + 8 = 9
- 通过C到N6的距离：1 + 4 = 5
- 通过C到N8的距离：1 + 3 = 4
- 通过C到N9的距离：1 + 5 = 6

逐网络更新：
- **N1**：当前距离7，通过C距离∞，因此保持当前（距离7，下一跳A）。
- **N2**：当前距离2，通过C距离5，2 < 5，因此保持当前（距离2，下一跳C）。
- **N3**：当前路由表中无N3，通过C距离9，因此添加N3（距离9，下一跳G）。
- **N6**：当前距离8，通过C距离5，5 < 8，因此更新（距离5，下一跳G）。
- **N8**：当前距离4，通过C距离4，距离相同，因此保持当前下一跳（距离4，下一跳F）。
- **N9**：当前距离4，通过C距离6，4 < 6，因此保持当前（距离4，下一跳F）。

更新后的路由器B的路由表如下：

| 目的网络 | 距离 | 下一跳 |
|----------|------|--------|
| N1       | 7    | A      |
| N2       | 2    | C      |
| N3       | 9    | G      |
| N6       | 5    | G      |
| N8       | 4    | F      |
| N9       | 4    | F      |
