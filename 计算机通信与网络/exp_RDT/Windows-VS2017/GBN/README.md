# GBN 协议实现 (Go-Back-N Protocol)

## 协议概述

这是一个基于 C++ 实现的 Go-Back-N (GBN) 可靠数据传输协议。GBN 协议是一种滑动窗口协议，支持流水线传输，能够在不可靠的网络环境中提供可靠的数据传输服务。

## 主要特性

- **滑动窗口机制**：支持多分组同时传输
- **累积确认**：接收方只按顺序确认分组
- **超时重传**：发送方为最早未确认的分组设置单一计时器
- **序列号管理**：使用固定大小的序列号空间（默认为 8）
- **错误检测**：通过校验和验证数据完整性

## 核心类说明

### GBNRdtSender (发送方)
- **窗口管理**：维护发送窗口，跟踪已发送但未确认的分组
- **超时处理**：实现超时重传机制
- **流量控制**：窗口满时拒绝上层应用数据
- **累积确认**：处理接收方的确认分组

### GBNRdtReceiver (接收方)
- **按序接收**：只接收期望序列号的分组
- **确认机制**：发送累积确认
- **错误处理**：丢弃损坏或乱序的分组，重发上次确认

## 配置参数

- **窗口大小**：默认为 4 个分组
- **序列号空间**：默认为 8（3 位序列号）
- **超时时间**：在 Configuration 中配置

## 编译和运行

### 环境要求
- Visual Studio 2017 或更高版本
- Windows 操作系统

### 编译步骤
1. 打开解决方案文件 (.sln)
2. 选择编译配置 (Debug/Release)
3. 编译项目

### 运行程序
程序会自动：
- 从 `input.txt` 读取输入数据
- 执行 GBN 协议传输
- 将结果输出到 `output.txt`
- 在控制台显示详细的传输过程

## 输出说明

### 控制台输出
程序提供两种运行模式：
- **VERBOSE 模式**：显示详细的传输过程和状态信息
- **安静模式**：只显示关键信息

控制台输出包括：
- 发送方和接收方的状态变化
- 滑动窗口的可视化显示
- 分组发送、接收和确认的详细信息
- 超时和重传事件

### 滑动窗口显示格式
```
[ [ 0 1 2* 3 ] - - - - ] (base=0, nextSeq=2, windowSize=4)
```
- `[ ]` 表示窗口边界
- `*` 标记下一个要发送的序列号
- `-` 表示不在窗口内的序列号
- 括号内显示当前窗口参数

## 实现细节

### 发送方逻辑
1. 上层应用调用 `send()` 发送数据
2. 如果窗口未满，将数据封装为分组并发送
3. 启动计时器（如果这是窗口中的第一个分组）
4. 收到确认后，移动窗口基序号
5. 超时时重传所有已发送但未确认的分组

### 接收方逻辑
1. 检查接收到的分组校验和
2. 如果分组是期望的序列号，交付给上层并发送确认
3. 如果分组损坏或乱序，丢弃并重发上次确认
4. 只按顺序接收分组

## 测试和验证

程序包含完整的错误处理机制，可以测试以下场景：
- 正常的数据传输
- 分组丢失
- 分组损坏
- 确认丢失
- 乱序到达

## 扩展和自定义

可以通过修改以下参数来调整协议行为：
- 在 `GBNRdtSender` 构造函数中修改窗口大小和序列号空间
- 在 `Configuration` 中调整超时时间
- 修改输入输出文件路径

## 注意事项

- 确保输入文件存在且格式正确
- 序列号空间应大于等于窗口大小的两倍
- 程序使用模拟网络环境，不涉及真实网络通信
